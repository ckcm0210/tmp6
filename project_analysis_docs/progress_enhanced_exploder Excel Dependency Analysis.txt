Excel Dependency Analysis ç³»çµ±æª”æ¡ˆé—œä¿‚ç¸½çµå ±å‘Š
æ—¥æœŸ: 2025-01-10
ç”¨æˆ¶: ckcm0210
å°è©±ä¸»é¡Œ: INDEXå‡½æ•¸æ”¯æ´åŠåœ–è¡¨é¡¯ç¤ºå•é¡Œ

ğŸ¯ æ ¸å¿ƒå•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ
å•é¡Œ1: INDEXå‡½æ•¸ç„¡æ³•æ­£ç¢ºexplode
ç¾è±¡: INDEXå‡½æ•¸è§£æå¾Œæ²’æœ‰å±•é–‹å­ç¯€é»
æ ¹å› : progress_enhanced_exploder.py ç¼ºå°‘INDEXè§£ææ”¯æ´
è§£æ±º: æ·»åŠ å®Œæ•´çš„INDEXè§£æé‚è¼¯ï¼ŒåŒ…æ‹¬åƒæ•¸æå–ã€éœæ…‹å¼•ç”¨æ§‹å»ºç­‰
å•é¡Œ2: resolved formulaç„¡æ³•åœ¨æ¨¹ç‹€åœ–é¡¯ç¤º
ç¾è±¡: INDEXè§£æçš„resolvedçµæœä¸é¡¯ç¤ºåœ¨worksheet treeä¸­
æ ¹å› : worksheet_tree.py çš„æ¢ä»¶åˆ¤æ–·åªæ”¯æ´INDIRECT
è§£æ±º: ä¿®æ”¹æ¢ä»¶ç‚º has_indirect or has_index
å•é¡Œ3: resolved formulaç„¡æ³•åœ¨ä¾è³´åœ–é¡¯ç¤º
ç¾è±¡: INDEXçš„resolvedçµæœä¸é¡¯ç¤ºåœ¨dependency graphä¸­
æ ¹å› : GraphGeneratoré¡ç¼ºå°‘INDEXæ”¯æ´å’Œé¡¯ç¤ºé¸é …
è§£æ±º: æ·»åŠ å®Œæ•´çš„resolvedè™•ç†é‚è¼¯å’Œæ§åˆ¶é¸é …
ğŸ—ï¸ ç³»çµ±æ¶æ§‹èˆ‡æª”æ¡ˆé—œä¿‚
æ ¸å¿ƒè™•ç†æµç¨‹
Code
ç”¨æˆ¶æ“ä½œ â†’ progress_enhanced_exploder.py â†’ worksheet_tree.py â†’ GraphGenerator
    â†“              â†“                           â†“               â†“
  explode       è§£æ&åˆ†æ                   æ¨¹ç‹€é¡¯ç¤º        åœ–è¡¨é¡¯ç¤º
ä¸»è¦æª”æ¡ˆåŠè·è²¬
1. progress_enhanced_exploder.py
è·è²¬: ğŸ”§ æ ¸å¿ƒåˆ†æå¼•æ“

åŠŸèƒ½: åŸ·è¡Œå¯¦éš›çš„dependency explosionåˆ†æ
è™•ç†: INDIRECTã€INDEXã€ç¯„åœå¼•ç”¨ã€å¾ªç’°æª¢æ¸¬
è¼¸å‡º: å®Œæ•´çš„ä¾è³´æ¨¹ç¯€é»çµæ§‹
é—œéµæ–¹æ³•:
explode_dependencies() - ä¸»è¦åˆ†ææ–¹æ³•
_resolve_indirect_with_excel() - INDIRECTè§£æ
_resolve_index_with_excel_corrected_simple() - INDEXè§£æ
_create_node_with_dynamic_functions() - ç¯€é»å‰µå»º
2. worksheet_tree.py
è·è²¬: ğŸŒ³ æ¨¹ç‹€è¦–åœ–é¡¯ç¤º

åŠŸèƒ½: å°‡exploderçš„çµæœè½‰æ›ç‚ºTreeViewé¡¯ç¤º
è™•ç†: ç¯€é»æ¨™ç±¤æ ¼å¼åŒ–ã€resolved formulaé¡¯ç¤º
é—œéµæ–¹æ³•:
populate_tree() - æ¨¹ç‹€çµæ§‹å»ºç«‹
ä¿®æ”¹é»: if (node.get('has_indirect', False) or node.get('has_index', False)):
3. GraphGeneratoré¡
è·è²¬: ğŸ“Š åœ–è¡¨è¦–è¦ºåŒ–

åŠŸèƒ½: ç”Ÿæˆç¨ç«‹çš„HTMLä¾è³´é—œä¿‚åœ–
è™•ç†: ç¯€é»ä½ˆå±€ã€ç”¨æˆ¶äº¤äº’é¸é …ã€resolved formulaé¡¯ç¤º
é—œéµæ–¹æ³•:
_generate_standalone_html() - HTMLç”Ÿæˆ
updateNodeLabels() - JavaScriptç¯€é»æ¨™ç±¤æ›´æ–°
ğŸ”„ åŠŸèƒ½å¯¦ç¾çš„æª”æ¡ˆä¿®æ”¹éˆ
å¯¦ç¾INDEXæ”¯æ´çš„å®Œæ•´ä¿®æ”¹éˆ:
progress_enhanced_exploder.py

âœ… æ·»åŠ _resolve_index_with_excel_corrected_simple()
âœ… ä¿®æ”¹explode_dependencies()æ”¯æ´INDEXè™•ç†
âœ… æ›´æ–°_create_node_with_dynamic_functions()
worksheet_tree.py

âœ… ä¿®æ”¹resolved formulaé¡¯ç¤ºæ¢ä»¶
âœ… ç¢ºä¿INDEXç¯€é»æ­£ç¢ºé¡¯ç¤ºresolvedå…§å®¹
GraphGenerator

âœ… æ·»åŠ resolved formulaè™•ç†é‚è¼¯
âœ… å¯¦ç¾åˆ†è¡Œé¡¯ç¤ºåŠŸèƒ½
âœ… æ·»åŠ ç”¨æˆ¶æ§åˆ¶é¸é …
âš™ï¸ é…ç½®èˆ‡é¸é …
Display Options æœ€çµ‚ç‰ˆæœ¬:
Hide Address File Name - éš±è—æª”æ¡ˆè·¯å¾‘
Show Full Address Path - é¡¯ç¤ºå®Œæ•´åœ°å€è·¯å¾‘
Show Full Formula Path - é¡¯ç¤ºå®Œæ•´å…¬å¼è·¯å¾‘
Show Full Resolved Path - é¡¯ç¤ºå®Œæ•´resolvedè·¯å¾‘
é è¨­å€¼:
Vertical Spacing: 250px (åŸ450px)
Font Size: 14px
UI Font Size: 14px
ğŸ” é—œéµæŠ€è¡“ç´°ç¯€
INDEXè§£ææµç¨‹:
å‡½æ•¸æå–: _extract_all_index_functions_debug()
åƒæ•¸è§£æ: _extract_index_parameters_accurate_debug()
éœæ…‹å¼•ç”¨æ§‹å»º: _build_static_reference_from_index_simple()
å­ç¯€é»è™•ç†: è‡ªå‹•explodeåˆ°resolvedçš„å¼•ç”¨
Resolved Formulaé¡¯ç¤ºé‚è¼¯:
JavaScript
// å‹•æ…‹å‡½æ•¸(INDEX/INDIRECT)ç„¡æ¢ä»¶é¡¯ç¤º
if (node.has_dynamic_function) {
    shouldShowResolved = true;
    resolvedToUse = showFullResolved ? node.full_resolved_formula : node.short_resolved_formula;
}
// å…¶ä»–å‡½æ•¸æ ¹æ“šç”¨æˆ¶é¸é …æ±ºå®š
else if (showFullResolved) {
    shouldShowResolved = true;
    resolvedToUse = node.full_resolved_formula;
}
æ–‡å­—åˆ†è¡Œè™•ç†:
å¥—ç”¨ç¯„åœ: Formulaå’ŒResolvedå…§å®¹
æœ€å¤§å¯¬åº¦: 60å­—ç¬¦
åˆ†å‰²æ–¹å¼: æŒ‰ç©ºæ ¼åˆ†å‰²ï¼Œé¿å…ç¯€é»éå¯¬
ğŸš¨ é‡è¦ç™¼ç¾èˆ‡æ•™è¨“
æ¶æ§‹ç†è§£:
å–®ä¸€æª”æ¡ˆä¿®æ”¹çš„å±€é™æ€§: ä»¥ç‚ºåªä¿®æ”¹exploderå°±èƒ½å®Œæˆæ‰€æœ‰åŠŸèƒ½
é¡¯ç¤ºå±¤åˆ†é›¢: åˆ†æé‚è¼¯å’Œé¡¯ç¤ºé‚è¼¯åˆ†ä½ˆåœ¨ä¸åŒæª”æ¡ˆ
å¤šå±¤æ¬¡ä¾è³´: exploder â†’ tree view â†’ graph view çš„å®Œæ•´éˆè·¯
ä¿®æ”¹ç­–ç•¥:
åˆ†æå±¤: å…ˆç¢ºä¿progress_enhanced_exploder.pyæ­£ç¢ºè§£æ
é¡¯ç¤ºå±¤: å†ä¿®æ”¹worksheet_tree.pyå’ŒGraphGenerator
æ¸¬è©¦é©—è­‰: æ¯å±¤ä¿®æ”¹å¾Œéƒ½è¦æ¸¬è©¦ä¸Šä¸‹æ¸¸å½±éŸ¿
å¸¸è¦‹é™·é˜±:
æ¢ä»¶åˆ¤æ–·éºæ¼: åªæ”¹äº†has_indirectï¼Œå¿˜è¨˜has_index
æ•¸æ“šå‚³éæ–·å±¤: exploderç”Ÿæˆäº†resolvedï¼Œä½†é¡¯ç¤ºå±¤æ²’æ¥æ”¶
JavaScriptäº‹ä»¶å¤±æ•ˆ: HTMLæ§åˆ¶é …æ›´æ–°å¾Œéœ€è¦é‡æ–°ç¶å®šäº‹ä»¶
ğŸ“ æœªä¾†ç¶­è­·æŒ‡å—
æ–°å¢å‹•æ…‹å‡½æ•¸æ”¯æ´æ™‚éœ€è¦ä¿®æ”¹:
progress_enhanced_exploder.py: æ·»åŠ è§£æé‚è¼¯
worksheet_tree.py: æ›´æ–°é¡¯ç¤ºæ¢ä»¶
GraphGenerator: æ·»åŠ åœ–è¡¨æ”¯æ´
æ¸¬è©¦æ‰€æœ‰é¡¯ç¤ºå±¤: ç¢ºä¿å®Œæ•´éˆè·¯æ­£å¸¸
é¡¯ç¤ºé¸é …ä¿®æ”¹æ™‚éœ€è¦æª¢æŸ¥:
HTMLæ§åˆ¶é …: æ–°å¢checkbox/slider
JavaScriptäº‹ä»¶: ç¶å®šchangeäº‹ä»¶
æ¨™ç±¤æ›´æ–°é‚è¼¯: ä¿®æ”¹updateNodeLabelså‡½æ•¸
CSSæ¨£å¼: ç¢ºä¿æ§åˆ¶é¢æ¿å¯¬åº¦è¶³å¤ 
å»ºè­°: å»ºç«‹å®Œæ•´çš„æ¸¬è©¦æµç¨‹ï¼Œå¾explodeâ†’treeâ†’graphï¼Œç¢ºä¿æ¯å€‹ç’°ç¯€éƒ½æ­£å¸¸å·¥ä½œã€‚